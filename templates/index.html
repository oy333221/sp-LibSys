<!DOCTYPE html>
<html>
<head>
    <title>書籍借閱系統</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <div class="card">
        <h1>歡迎使用書籍借閱系統</h1>
        {% with messages = get_flashed_messages() %}
            {% if messages %}
                {% for message in messages %}
                    <p style="color: green;">{{ message }}</p>
                {% endfor %}
            {% endif %}
        {% endwith %}
        
        {% if session.user_id %}
            <p>已登入，歡迎！ 
                <a href="{{ url_for('logout') }}">登出</a> | 
                <a href="{{ url_for('show_qr', action='borrow') }}">借書 QR Code</a> | 
                <a href="{{ url_for('show_qr', action='return') }}">還書 QR Code</a> | 
                <a href="{{ url_for('return_book') }}">還書</a>
                {% if is_admin() %}
                    | <a href="{{ url_for('admin_review') }}">審核註冊</a>
                    | <a href="{{ url_for('admin_limits') }}">設定借書上限</a>
                    | <a href="{{ url_for('admin_books') }}">書籍狀態</a>
                {% endif %}
            </p>
        {% else %}
            <p>未登入，請 <a href="{{ url_for('login') }}">登入</a></p>
        {% endif %}
    </div>

    <div class="card">
        <h2>可借書籍清單</h2>
        {% if books %}
            <table>
                <tr>
                    <th>書名</th>
                    <th>作者</th>
                    <th>ISBN</th>
                    <th>描述</th>
                    <th>操作</th>
                </tr>
                {% for book in books %}
                    <tr>
                        <td>{{ book.title }}</td>
                        <td>{{ book.author }}</td>
                        <td>{{ book.isbn }}</td>
                        <td>{{ book.description or '無描述' }}</td>
                        <td>
                            <form method="POST" action="{{ url_for('borrow', book_id=book.id) }}">
                                <button type="submit">借書</button>
                            </form>
                        </td>
                    </tr>
                {% endfor %}
            </table>
        {% else %}
            <p>目前沒有可借的書籍。</p>
        {% endif %}
    </div>

    <div class="card">
        <a href="{{ url_for('register') }}">前往註冊</a><br>
        <a href="{{ url_for('add_book') }}">新增書籍</a>
    </div>
</body>
</html>